<!DOCTYPE html>
<html>
	<head>
		<meta charset="ISO-8859-1">
		<title>Change Password</title>
		<link rel="stylesheet" type="text/css" href="stylesheet.css">
	</head>
	<body>
		<h2 class="titles"><u>Password Reset</u></h2>
		<form class="text" method="POST" style="font-weight: bold;">
			<label for="old_password">Old Password</label><br>
			<input type="password" name="old_password" id="old_password" required placeholder="Password"><br><br>
			<label for="new_password1">New Password</label><br>
			<input type="password" name="new_password1" id="new_password1" required placeholder="Password"><br><br>
			<label for="new_password2">Password Confirm</label><br>
			<input type="password" name="new_password2" id="new_password2" required placeholder="Password"><br><br>
			<button type="submit" id="submitButton">Change Password</button>
		</form>
		<script type="text/javascript">
		    document.getElementById('submitButton').addEventListener('click', (e) => {
		    	e.preventDefault();
		    	let oldPassword = document.getElementById("old_password").value;
		    	let newPassword1 = document.getElementById("new_password1").value;
		    	let newPassword2 = document.getElementById("new_password2").value;
		    	const reqBody = {oldPassword, newPassword1, newPassword2};
		    	const xhr0 = new XMLHttpRequest();
		    	xhr0.onreadystatechange = () => {
		    		if(xhr0.readyState === 4 && xhr0.status === 200) {
	    				let updateStatus = xhr0.responseText;
	    				if(updateStatus == 'true'){
	    					alert("Password successfully changed");
	    					window.location.href = "index.html";
	    				}else{
	    					alert("Error: Password not changed.");
	    				}
		    		}
		    	};
		    	xhr0.open("POST", "update-password");
		    	xhr0.setRequestHeader("Content-Type", "application/json");
		    	xhr0.send(JSON.stringify(reqBody));
		    });
		</script>
	</body>
</html>