<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todos</title>
    <link href="style.css" rel="stylesheet" />

    <!-- JS is used to manipulate the DOM
        DOM -- tree like structure that represents the HTML document in memory

        HTML elements -- data held by the DOM Node
        HTML tags -- in the static html file
        DOM Nodes -- node in the DOM tree
    -->

    <!-- Ways of including JS in HTML
        external scripts -- <script src="">
        internal scripts -- <script>
        inline = <e onclick="">
    -->
  </head>
  <body>
    <aside class="sidebar">
      <ul id="lists-list"></ul>
    </aside>
    <main>
      <ul id="current-list-target"></ul>
      <form method="GET" action="">
        <input type='button' name='add-list' value="Add List" onclick="clicker(this);">
      </form>
      <form id='list_creator' style="display: none;" >
        <p>
          List Name: 
          <input type='text' name="newListName" placeholder="List Name">
        </p>
        <p>
          Number of items:
          <input type="number" name='number' placeholder="Enter a number">
        </p>
        <p>
          <input type="button" name="submit button" value="Let's make this list!" onclick="listMaker(newListName, number)">
        </p>
      </form>

    </main>
    <!-- this ensures that the DOM is completely loade first -->
    <script>
      class TodoItem {
        // JS classes all have a special constructor method named "constructor"
        // it is used like constructors in other languages
        // JS classes can extend other classes
        //if your JS class extends another class your must call super() in your constructor
        constructor(id, name) {
          this._id = id;
          this._name = name;
        }

        // there are no private modifiers in JS. An _ is generally used to denote a property that should be
        // treated as a private member
        // use get and set keywords to create getter and setter properties to manipulate "private" memebers

        get id() {
          return this._id;
        }

        set id(id) {
          this._id = id;
        }

        get name() {
          return this._name;
        }

        set name(name) {
          this._name = name;
        }
      }

      class TodoList {
        constructor(id, name, todos) {
          this._name = name;
          this._id = id;
          this._todos = todos || [];
        }

        get name() {
          return this._name;
        }

        set name(name) {
          this._name = name;
        }

        get todos() {
          return this._todos;
        }

        set todos(todos) {
          this._todos = todos;
        }

        get id() {
          return this._id;
        }

        set id(id) {
          this._id = id;
        }
      }

      const todoLists = [
        new TodoList(1, 'Karate Kid', [new TodoItem(1, 'Paint the fence'), new TodoItem(2,'Wax on')]),
        new TodoList(2, "Movies", [new TodoItem(1, 'Karate Kid'), new TodoItem(2, 'Karate Kid 2'), new TodoItem(3, 'Karate Kid 3'), 
                                  new TodoItem(4, "The Next Karate Kid"),new TodoItem(5, "Jackie Chan's Karate Kid")])
      ];

      

      let currentList = null;
      var listCounter = 2;

      // loop over all the todo lists adding eachone to the aside list for displaying
      todoLists.forEach((e) => {
        const li = document.createElement('li'); // create a disconnected element
        li.innerHTML = e.name;
        li.setAttribute('data-id', e.id);

        // add a click listener to the li for more interactivity
        // this will set the current list to displayed on the other section of the page
        li.addEventListener('click', (e) => {
          const targetId = parseInt(e.target.getAttribute('data-id'));
          currentList = todoLists.find((l) => l.id === targetId); // high order function
          renderList();
        });
        document.querySelector('#lists-list').appendChild(li); // connect the element to the tree as a child of ul#lists-list
      });
      function renderList() {
        document.querySelector('#current-list-target').innerHTML = '';
        currentList.todos.forEach((t) => {
          const span = document.createElement('li');
          span.innerHTML = t.name;
          document.querySelector('#current-list-target').appendChild(span);
        });
      }

      if (currentList === null) {
        document.querySelector('#current-list-target').innerHTML =
          'No list to display';
      }
      function clicker(element){
        document.getElementById('list_creator').reset();
        document.getElementById('list_creator').style.display="block";      
      }
      function listMaker(name, number){
        // alert("You've entered " + name.value + " and " + number.value);

        document.getElementById('list_creator').style.display="none";
        listCounter++;
        var arr = [];
        var i =1;
        while(i<=number.value){
          var listItem = prompt("Enter list item #"+i,"");
          var thingy = new TodoItem(i, listItem);
          arr.push(thingy);
          i++
        }
        var newList = new TodoList(listCounter, name.value, arr);
        todoLists.push(newList);
       
        const li = document.createElement('li'); // create a disconnected element
        li.innerHTML = newList.name;
        li.setAttribute('data-id', newList.id);
        li.addEventListener('click', (e) => {
          const targetId = parseInt(e.target.getAttribute('data-id'));
          currentList = todoLists.find((l) => l.id === targetId); // high order function
          renderList();
        });
        document.querySelector('#lists-list').appendChild(li); // connect the element to the tree as a child of ul#lists-list
      }
    </script>
  </body>
</html>
