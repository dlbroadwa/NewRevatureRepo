pipeline {
   agent any

   tools {
      maven "mvn"
      docker "docker"
   }

   stages {
      stage('WAR Generation') {
         steps {
		withMaven(maven : 'mvn'){
			sh 'mvn clean install'
		}
         }
      }
      stage('Docker Image Build'){
	 steps {
      		withDocker(docker : 'docker'){
			sh 'docker build . -t cm:v0'
		}
	}
      }
      stage('Docker Hub Image Push'){
	 steps {
      		withDocker(docker : 'docker'){
			sh 'docker tag cm:v0 jeanaldoph/voldemort:cm'
			sh 'docker push jeanaldoph/voldemort:cm'
		}
	}
      }
   }
}